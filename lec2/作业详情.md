# 作业：实现LDA多分类问题

使用 MATLAB 实现 LDA 多分类问题。

## 需要提交

### 代码文件
- `generate_stamps.m`
- `fit_lda.m`
- `test_lda.m`
- `main.m`

### 文档
- 运行结果截图
- 代码附录

## 参考资料：推广至多维特征多分类问题

设 $\boldsymbol{x}$ 有 M 个维度（$\boldsymbol{x} \in \mathbb{R}^M$），样本的特征应该来源于等协方差矩阵的 M 维高斯分布：
$$
\forall 1 \leq t \leq K, \quad X|Y = t \sim N(\mu_t, \Sigma^2)
$$
$$
P(\boldsymbol{x}|y = t) = \frac{1}{\sqrt{(2\pi)^M \det \Sigma}} \exp\left[ -\frac{1}{2}(\boldsymbol{x} - \mu_t)^T\Sigma^{-1}(\boldsymbol{x} - \mu_t)^T \right]
$$

设样本的分类标签总数为 K，各类别的先验概率为 $p_k$，自然的 $\sum p_k = 1$。

对任意两个不同类别 $t_1, t_2$，导出判别函数：
$$
\begin{aligned}
\ln \frac{P(y=t_1|\boldsymbol{x})}{P(y=t_2|\boldsymbol{x})} &= \ln \frac{P(\boldsymbol{x}|y = t_1)p_{t_1}}{P(\boldsymbol{x}|y = t_2)p_{t_2}} \\
&= \ln \frac{P(\boldsymbol{x}|y = t_1)}{P(\boldsymbol{x}|y = t_2)} + \ln \frac{p_{t_1}}{p_{t_2}} \\
&= \left( \boldsymbol{x}^T\Sigma^{-1}\mu_{t_1} - \frac{1}{2}\mu_{t_1}^T\Sigma^{-1}\mu_{t_1} \right) - \left( \boldsymbol{x}^T\Sigma^{-1}\mu_{t_2} - \frac{1}{2}\mu_{t_2}^T\Sigma^{-1}\mu_{t_2} \right) + \ln \frac{p_{t_1}}{p_{t_2}}
\end{aligned}
$$

由上述推导，类别 $k$ 的判别函数（决策函数）可以定义为：
$$
\delta_k(\boldsymbol{x}) = \boldsymbol{x}^T\Sigma^{-1}\mu_k - \frac{1}{2}\mu_k^T\Sigma^{-1}\mu_k + \ln p_k
$$

因此 $\boldsymbol{x}$ 的分类标签为：
$$
\underset{1 \leq k \leq K}{\arg\max}\{\delta_k(\boldsymbol{x})\}
$$

判别函数中的参数由数据估计得到：
$$
\hat{\mu}_k = \frac{1}{N_k} \sum_{\boldsymbol{x}_i \in C_k} \boldsymbol{x}_i
$$
$$
\hat{p}_k = \frac{N_k}{N}
$$
$$
\hat{\Sigma} = \frac{1}{N - K} \sum_{k=1}^K \sum_{\boldsymbol{x}_i \in C_k} (\boldsymbol{x}_i - \hat{\mu}_k)(\boldsymbol{x}_i - \hat{\mu}_k)^T
$$